# QuantlinkTrader é¡¹ç›®å¼€å‘è§„åˆ™

## é¡¹ç›®æ¦‚è¿°

QuantlinkTrader æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½é‡åŒ–äº¤æ˜“ç³»ç»Ÿï¼Œé‡‡ç”¨ C++ ç½‘å…³ + Golang ç­–ç•¥å¼•æ“çš„æ··åˆæ¶æ„ã€‚

**å…³é”®æ–‡æ¡£**:
- æ–‡æ¡£ç´¢å¼•ä¸­å¿ƒ: @docs/README.md
- ç³»ç»Ÿæ¶æ„: @docs/æ ¸å¿ƒæ–‡æ¡£/CURRENT_ARCHITECTURE_FLOW.md
- æ„å»ºæŒ‡å—: @docs/æ ¸å¿ƒæ–‡æ¡£/BUILD_GUIDE.md
- ä½¿ç”¨è¯´æ˜: @docs/æ ¸å¿ƒæ–‡æ¡£/USAGE.md
- æœ€æ–°å®ç›˜æŠ¥å‘Š: @docs/å®ç›˜/Phase2-5_å®Œæ•´æŒä»“ç®¡ç†åŠŸèƒ½å®æ–½æŠ¥å‘Š_2026-01-30-11_35.md

---

## ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒç»„ä»¶

1. **C++ ç½‘å…³å±‚** (`gateway/`)
   - `md_simulator`: æ¨¡æ‹Ÿè¡Œæƒ…æ•°æ®ç”Ÿæˆå™¨
   - `md_gateway`: è¡Œæƒ…ç½‘å…³ï¼ˆå…±äº«å†…å­˜ â†’ NATSï¼‰
   - `ors_gateway`: è®¢å•è·¯ç”±æœåŠ¡ï¼ˆgRPC â†’ å…±äº«å†…å­˜ï¼‰
   - `counter_gateway`: æ¨¡æ‹Ÿæˆäº¤ç½‘å…³

2. **Golang ç­–ç•¥å±‚** (`golang/`)
   - `pkg/trader/`: äº¤æ˜“ä¸»ç¨‹åº
   - `pkg/strategy/`: ç­–ç•¥å¼•æ“
   - `pkg/portfolio/`: ç»„åˆç®¡ç†
   - `pkg/risk/`: é£æ§æ¨¡å—

3. **é€šä¿¡æœºåˆ¶**
   - POSIX å…±äº«å†…å­˜: C++ ç½‘å…³é—´é€šä¿¡ï¼ˆä½å»¶è¿Ÿï¼‰
   - NATS: è¡Œæƒ…æ•°æ®åˆ†å‘ï¼ˆmd_gateway â†’ golang_traderï¼‰
   - gRPC: è®¢å•è·¯ç”±ï¼ˆgolang_trader â†’ ors_gatewayï¼‰

### æ•°æ®æµå‘

```
md_simulator â†’ [SHM] â†’ md_gateway â†’ [NATS] â†’ golang_trader â†’ [gRPC] â†’ ors_gateway â†’ [SHM] â†’ counter_gateway
```

---

## ä»£ç é£æ ¼è§„èŒƒ

### C++ ä»£ç  (`gateway/`)

- **é£æ ¼æŒ‡å—**: éµå¾ª Google C++ Style Guide
- **å‘½åè§„èŒƒ**:
  - ç±»å: PascalCase (ä¾‹å¦‚: `MarketDataGateway`)
  - å‡½æ•°å: camelCase (ä¾‹å¦‚: `processMarketData()`)
  - æˆå‘˜å˜é‡: `m_` å‰ç¼€ (ä¾‹å¦‚: `m_isRunning`)
  - å¸¸é‡: UPPER_SNAKE_CASE (ä¾‹å¦‚: `MAX_QUEUE_SIZE`)
- **å¤´æ–‡ä»¶**:
  - ä½¿ç”¨ `#pragma once` è€Œä¸æ˜¯ include guards
  - å¤´æ–‡ä»¶åŒ…å«é¡ºåº: æ ‡å‡†åº“ â†’ ç¬¬ä¸‰æ–¹åº“ â†’ é¡¹ç›®å¤´æ–‡ä»¶
- **å…±äº«å†…å­˜**:
  - ä½¿ç”¨ POSIX `shm_open` / `mmap`
  - é˜Ÿåˆ—åæ ¼å¼: `ors_request`, `ors_response`, `md_queue`

### Golang ä»£ç  (`golang/`)

- **é£æ ¼æŒ‡å—**: ä½¿ç”¨ `gofmt` è‡ªåŠ¨æ ¼å¼åŒ–
- **åŒ…å‘½å**: å…¨å°å†™ï¼Œå•æ•°å½¢å¼ (ä¾‹å¦‚: `trader`, `strategy`, `risk`)
- **æ¥å£å‘½å**:
  - å•æ–¹æ³•æ¥å£ä»¥ `-er` ç»“å°¾ (ä¾‹å¦‚: `Reader`, `Writer`)
  - å¤šæ–¹æ³•æ¥å£ä½¿ç”¨æè¿°æ€§åç§° (ä¾‹å¦‚: `StrategyEngine`)
- **é”™è¯¯å¤„ç†**:
  - æ€»æ˜¯æ£€æŸ¥ error è¿”å›å€¼
  - ä½¿ç”¨ `log.Printf` è®°å½•é”™è¯¯ï¼Œä¸è¦ panicï¼ˆé™¤éåˆå§‹åŒ–å¤±è´¥ï¼‰
- **æ—¥å¿—æ ¼å¼**: `log.Printf("[æ¨¡å—å] æ¶ˆæ¯å†…å®¹")`

### é…ç½®æ–‡ä»¶ (`config/`)

- **æ ¼å¼**: YAML
- **å‘½å**:
  - ç”Ÿäº§é…ç½®: `trader.yaml`
  - æµ‹è¯•é…ç½®: `trader.test.yaml`
- **å¿…å¡«å­—æ®µ**:
  - `system.strategy_id`: ç­–ç•¥å”¯ä¸€æ ‡è¯†
  - `strategy.symbols`: äº¤æ˜“å“ç§åˆ—è¡¨
  - `engine.ors_gateway_addr`: ORS ç½‘å…³åœ°å€
  - `engine.nats_addr`: NATS æœåŠ¡åœ°å€

---

## æ–‡æ¡£è§„èŒƒ

### æ–‡æ¡£å­˜æ”¾ä½ç½®

**è§„åˆ™ 1: æ–‡æ¡£ç›®å½•ç»“æ„ï¼ˆ2026-01-30 é‡ç»„ï¼‰**

æ–‡æ¡£å·²æŒ‰ä¸»é¢˜åˆ†ç±»åˆ°10ä¸ªç›®å½•ï¼Œæ ¹ç›®å½•ä»…ä¿ç•™ `README.md` ç´¢å¼•æ–‡ä»¶ã€‚

**ä¸»é¢˜ç›®å½•**:
- `docs/æ ¸å¿ƒæ–‡æ¡£/`: ç³»ç»Ÿæ¶æ„ã€æ„å»ºæŒ‡å—ã€ä½¿ç”¨è¯´æ˜ç­‰æ ¸å¿ƒæ–‡æ¡£ï¼ˆ4ä¸ªï¼‰
- `docs/å®ç›˜/`: å®ç›˜éƒ¨ç½²ã€å‚æ•°é…ç½®ã€æŒä»“ç®¡ç†ç›¸å…³ï¼ˆ5ä¸ªï¼‰
- `docs/å›æµ‹/`: å›æµ‹ç³»ç»Ÿä½¿ç”¨ã€å‚æ•°ä¼˜åŒ–ç›¸å…³ï¼ˆ7ä¸ªï¼‰
- `docs/æµ‹è¯•æŠ¥å‘Š/`: ç«¯åˆ°ç«¯æµ‹è¯•ã€åŠŸèƒ½æµ‹è¯•æŠ¥å‘Šï¼ˆ8ä¸ªï¼‰
- `docs/åŠŸèƒ½å®ç°/`: æ–°åŠŸèƒ½å®æ–½æŠ¥å‘Šå’ŒæŒ‡å—ï¼ˆ10ä¸ªï¼‰
- `docs/ç³»ç»Ÿåˆ†æ/`: ç³»ç»Ÿæ¶æ„åˆ†æã€é…ç½®è¯´æ˜ï¼ˆ6ä¸ªï¼‰
- `docs/golang/`: Golangæ¨¡å—æŠ€æœ¯æ–‡æ¡£ï¼ˆ35ä¸ªï¼‰
- `docs/gateway/`: Gatewayæ¨¡å—æ–‡æ¡£ï¼ˆ4ä¸ªï¼‰
- `docs/archive/`: å·²å½’æ¡£çš„æ—§æ–‡æ¡£ï¼ˆ35ä¸ªï¼‰

**IMPORTANT: åˆ›å»ºæ–°æ–‡æ¡£æ—¶çš„æ”¾ç½®è§„åˆ™**:
1. **å®ç›˜éƒ¨ç½²ã€é—®é¢˜ä¿®å¤** â†’ `docs/å®ç›˜/`
2. **å›æµ‹ç³»ç»Ÿã€å‚æ•°ä¼˜åŒ–** â†’ `docs/å›æµ‹/`
3. **æµ‹è¯•æŠ¥å‘Šã€éªŒè¯ç»“æœ** â†’ `docs/æµ‹è¯•æŠ¥å‘Š/`
4. **æ–°åŠŸèƒ½å®æ–½** â†’ `docs/åŠŸèƒ½å®ç°/`
5. **ç³»ç»Ÿåˆ†æã€æ¶æ„è®¾è®¡** â†’ `docs/ç³»ç»Ÿåˆ†æ/`
6. **GolangæŠ€æœ¯ç»†èŠ‚** â†’ `docs/golang/`
7. **Gatewayå®ç°** â†’ `docs/gateway/`
8. **è¿‡æ—¶æ–‡æ¡£** â†’ `docs/archive/`
9. **æ ¸å¿ƒæ–‡æ¡£æ›´æ–°** â†’ è°¨æ…æ“ä½œï¼Œè¿™äº›æ˜¯é•¿æœŸç»´æŠ¤çš„åŸºç¡€æ–‡æ¡£

**ç›®å½•ç»“æ„**:
```
quantlink-trade-system/
â”œâ”€â”€ docs/                                    # æ–‡æ¡£æ ¹ç›®å½•
â”‚   â”œâ”€â”€ README.md                            # æ–‡æ¡£ç´¢å¼•ä¸­å¿ƒï¼ˆå¿…çœ‹ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ æ ¸å¿ƒæ–‡æ¡£/                            # ç³»ç»Ÿæ ¸å¿ƒæ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ CURRENT_ARCHITECTURE_FLOW.md
â”‚   â”‚   â”œâ”€â”€ BUILD_GUIDE.md
â”‚   â”‚   â”œâ”€â”€ PROJECT_OVERVIEW.md
â”‚   â”‚   â””â”€â”€ USAGE.md
â”‚   â”‚
â”‚   â”œâ”€â”€ å®ç›˜/                                # å®ç›˜äº¤æ˜“ç›¸å…³
â”‚   â”‚   â”œâ”€â”€ Phase2-5_å®Œæ•´æŒä»“ç®¡ç†åŠŸèƒ½å®æ–½æŠ¥å‘Š_2026-01-30-11_35.md
â”‚   â”‚   â”œâ”€â”€ å‚æ•°åŠ è½½ä¿®å¤æŠ¥å‘Š_2026-01-30-11_05.md
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ å›æµ‹/                                # å›æµ‹ç³»ç»Ÿæ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ å›æµ‹_ä½¿ç”¨æŒ‡å—_2026-01-24-19_00.md
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ æµ‹è¯•æŠ¥å‘Š/                            # å„ç±»æµ‹è¯•æŠ¥å‘Š
â”‚   â”œâ”€â”€ åŠŸèƒ½å®ç°/                            # åŠŸèƒ½å®æ–½æ–‡æ¡£
â”‚   â”œâ”€â”€ ç³»ç»Ÿåˆ†æ/                            # ç³»ç»Ÿåˆ†ææ–‡æ¡£
â”‚   â”œâ”€â”€ golang/                              # Golangæ¨¡å—æ–‡æ¡£
â”‚   â”œâ”€â”€ gateway/                             # Gatewayæ¨¡å—æ–‡æ¡£
â”‚   â””â”€â”€ archive/                             # å·²å½’æ¡£æ–‡æ¡£
â”‚
â”œâ”€â”€ gateway/                                 # C++ ç½‘å…³ä»£ç 
â”‚   â””â”€â”€ src/
â””â”€â”€ golang/                                  # Golang ç­–ç•¥ä»£ç 
    â””â”€â”€ pkg/
```

**æŸ¥æ‰¾æ–‡æ¡£**:
- é¦–å…ˆæŸ¥çœ‹ `docs/README.md` è·å–å®Œæ•´ç´¢å¼•å’Œå¯¼èˆª
- æŒ‰ä¸»é¢˜è¿›å…¥ç›¸åº”ç›®å½•æŸ¥æ‰¾å…·ä½“æ–‡æ¡£
- ä½¿ç”¨ `find docs -name "*å…³é”®è¯*"` æœç´¢ç‰¹å®šæ–‡æ¡£

### æ–‡æ¡£å‘½åè§„èŒƒ

**è§„åˆ™ 2: æ–‡æ¡£å‘½åæ ¼å¼**

**æ ¼å¼**: `æ¨¡å—_æ‘˜è¦_YYYY-MM-DD-HH_mm.md`

**ç»„æˆéƒ¨åˆ†**:
- **æ¨¡å—**: æ–‡æ¡£æ‰€å±æ¨¡å—æˆ–ä¸»é¢˜ï¼ˆå°å†™æˆ–é©¼å³°ï¼‰
  - å•æ¨¡å—: `gateway`, `golang`, `config`, `strategy`, `risk` ç­‰
  - å¤šæ¨¡å—/ç³»ç»Ÿçº§: `QuantlinkTrader`, `ç³»ç»Ÿ`, `é¡¹ç›®`, `éƒ¨ç½²` ç­‰
- **æ‘˜è¦**: ç®€çŸ­æè¿°æ–‡æ¡£å†…å®¹ï¼ˆ2-5 ä¸ªå­—ï¼Œä¸­æ–‡ï¼‰
- **æ—¶é—´æˆ³**: `YYYY-MM-DD-HH_mm` æ ¼å¼ï¼ˆ24 å°æ—¶åˆ¶ï¼‰

**å‘½åç¤ºä¾‹**:

```bash
# âœ… æ­£ç¡®ç¤ºä¾‹
docs/QuantlinkTrader_ç«¯åˆ°ç«¯æµ‹è¯•æŠ¥å‘Š_2026-01-24-15_32.md    # é€šç”¨æ–‡æ¡£
docs/ç³»ç»Ÿ_æ¶æ„è®¾è®¡_2026-01-20-10_00.md                       # é€šç”¨æ–‡æ¡£
docs/éƒ¨ç½²_ç”Ÿäº§ç¯å¢ƒæŒ‡å—_2026-01-21-14_30.md                   # é€šç”¨æ–‡æ¡£

docs/gateway/gateway_å…±äº«å†…å­˜ä¼˜åŒ–_2026-01-15-09_20.md       # Gateway æ¨¡å—æ–‡æ¡£
docs/gateway/gateway_æ€§èƒ½æµ‹è¯•æŠ¥å‘Š_2026-01-16-11_45.md       # Gateway æ¨¡å—æ–‡æ¡£

docs/golang/golang_ç­–ç•¥å¼•æ“è®¾è®¡_2026-01-18-13_15.md         # Golang æ¨¡å—æ–‡æ¡£
docs/golang/golang_é£æ§æ¨¡å—å®ç°_2026-01-19-16_00.md         # Golang æ¨¡å—æ–‡æ¡£
docs/golang/strategy_é…å¯¹å¥—åˆ©ç­–ç•¥_2026-01-22-10_30.md       # Golang æ¨¡å—æ–‡æ¡£

# âŒ é”™è¯¯ç¤ºä¾‹
docs/test_report.md                                         # ç¼ºå°‘æ—¶é—´æˆ³
docs/EndToEndTest_2026-01-24.md                            # ä½¿ç”¨è‹±æ–‡ï¼Œç¼ºå°‘æ—¶åˆ†
gateway/docs/gateway_å…±äº«å†…å­˜ä¼˜åŒ–.md                         # é”™è¯¯ä½ç½®
docs/ç³»ç»Ÿæ¶æ„_20260120.md                                    # æ—¶é—´æ ¼å¼ä¸æ­£ç¡®
```

### æ–‡æ¡£å†…å®¹è§„èŒƒ

**è§„åˆ™ 3: ä½¿ç”¨ä¸­æ–‡ç¼–å†™**

- **æ–‡æ¡£æ­£æ–‡**: å¿…é¡»ä½¿ç”¨ä¸­æ–‡
- **æ ‡é¢˜**: ä½¿ç”¨ä¸­æ–‡
- **æ³¨é‡Š**: ä½¿ç”¨ä¸­æ–‡
- **ä¾‹å¤–æƒ…å†µ**:
  - ä»£ç ç‰‡æ®µ: ä¿æŒåŸå§‹è¯­è¨€ï¼ˆC++/Golang/Shell ç­‰ï¼‰
  - å‘½ä»¤ç¤ºä¾‹: ä¿æŒåŸå§‹å‘½ä»¤
  - æŠ€æœ¯æœ¯è¯­: å¯ä¿ç•™è‹±æ–‡ï¼Œä½†é¦–æ¬¡å‡ºç°æ—¶æä¾›ä¸­æ–‡è¯´æ˜
  - æ–‡ä»¶è·¯å¾„: ä¿æŒåŸå§‹è·¯å¾„
  - URL é“¾æ¥: ä¿æŒåŸå§‹é“¾æ¥

**ç¤ºä¾‹**:

```markdown
# âœ… æ­£ç¡®ç¤ºä¾‹

## ç­–ç•¥å¼•æ“è®¾è®¡

ç­–ç•¥å¼•æ“ï¼ˆStrategy Engineï¼‰è´Ÿè´£æ¥æ”¶å¸‚åœºæ•°æ®å¹¶ç”Ÿæˆäº¤æ˜“ä¿¡å·ã€‚

### æ ¸å¿ƒæ¥å£

\`\`\`go
type StrategyEngine interface {
    Start() error
    Stop() error
}
\`\`\`

### è¿è¡Œæ–¹å¼

æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨ç­–ç•¥å¼•æ“ï¼š

\`\`\`bash
./bin/trader -config config/trader.yaml
\`\`\`

---

# âŒ é”™è¯¯ç¤ºä¾‹

## Strategy Engine Design

The strategy engine is responsible for receiving market data...
```

### æ–‡æ¡£æ¨¡æ¿

**æ ‡å‡†æ–‡æ¡£æ¨¡æ¿**:

```markdown
# æ¨¡å—å_æ–‡æ¡£æ ‡é¢˜

**æ–‡æ¡£æ—¥æœŸ**: YYYY-MM-DD
**ä½œè€…**: [ä½œè€…å]
**ç‰ˆæœ¬**: v1.0
**ç›¸å…³æ¨¡å—**: [æ¨¡å—åˆ—è¡¨]

---

## æ¦‚è¿°

[ç®€è¦æè¿°æ–‡æ¡£ç›®çš„å’ŒèƒŒæ™¯]

## è¯¦ç»†å†…å®¹

### ç« èŠ‚ 1

[å†…å®¹...]

### ç« èŠ‚ 2

[å†…å®¹...]

## æ€»ç»“

[æ€»ç»“è¦ç‚¹]

## å‚è€ƒèµ„æ–™

- ç›¸å…³æ–‡æ¡£1: @docs/xxx.md
- ç›¸å…³æ–‡æ¡£2: @gateway/docs/xxx.md

---

**æœ€åæ›´æ–°**: YYYY-MM-DD HH:mm
```

### æ–‡æ¡£ç»´æŠ¤

**è§„åˆ™ 4: æ–‡æ¡£ç”Ÿå‘½å‘¨æœŸ**

- **åˆ›å»ºæ–‡æ¡£**: é‡å¤§åŠŸèƒ½ã€æ¶æ„å˜æ›´ã€æµ‹è¯•æŠ¥å‘Šæ—¶åˆ›å»º
- **æ›´æ–°æ–‡æ¡£**: ä¸ä¿®æ”¹åŸæ–‡ä»¶ï¼Œè€Œæ˜¯åˆ›å»ºæ–°ç‰ˆæœ¬ï¼ˆå¸¦æ–°æ—¶é—´æˆ³ï¼‰
- **åºŸå¼ƒæ–‡æ¡£**: ç§»åŠ¨åˆ° `docs/archive/` ç›®å½•
- **æ–‡æ¡£ç´¢å¼•**: åœ¨ `docs/README.md` ä¸­ç»´æŠ¤æ–‡æ¡£ç´¢å¼•ï¼ˆé‡è¦æ–‡æ¡£éœ€è¦æ·»åŠ ï¼‰

**IMPORTANT: æ–‡æ¡£ç´¢å¼•ç»´æŠ¤**

å½“åˆ›å»ºé‡è¦æ–‡æ¡£æ—¶ï¼Œéœ€è¦æ›´æ–° `docs/README.md` ä¸­çš„ç›¸åº”ç« èŠ‚ï¼š

1. **æ ¸å¿ƒæ–‡æ¡£** - å¾ˆå°‘æ›´æ–°ï¼Œé™¤éé‡å¤§æ¶æ„å˜æ›´
2. **å®ç›˜ç›¸å…³** - æ·»åŠ é‡å¤§é—®é¢˜ä¿®å¤ã€æ–°åŠŸèƒ½å®æ–½
3. **å›æµ‹ç›¸å…³** - æ·»åŠ æ–°çš„ä½¿ç”¨æŒ‡å—æˆ–é‡å¤§ä¼˜åŒ–
4. **æµ‹è¯•æŠ¥å‘Š** - æ·»åŠ é‡å¤§æµ‹è¯•æŠ¥å‘Šï¼ˆé‡Œç¨‹ç¢‘å¼çš„ï¼‰
5. **åŠŸèƒ½å®ç°** - æ·»åŠ æ–°åŠŸèƒ½å®æ–½æŠ¥å‘Š
6. **ç³»ç»Ÿåˆ†æ** - æ·»åŠ é‡è¦çš„æ¶æ„åˆ†ææ–‡æ¡£

**æ–‡æ¡£ç´¢å¼•ç»“æ„** (`docs/README.md`):

```markdown
# QuantLink Trade System - æ–‡æ¡£ä¸­å¿ƒ

## ğŸ“ æ–‡æ¡£ç›®å½•ç»“æ„
[æ˜¾ç¤º10ä¸ªä¸»é¢˜ç›®å½•]

## ğŸš€ å¿«é€Ÿå¼€å§‹
[æ–°ç”¨æˆ·å¿…è¯»ã€å¼€å‘è€…æŒ‡å—]

## ğŸ“š ä¸»é¢˜æ–‡æ¡£å¯¼èˆª

### ğŸ’¼ å®ç›˜äº¤æ˜“
**ç›®å½•**: `docs/å®ç›˜/`
**æœ€æ–°æ–‡æ¡£**:
- âœ… [Phase2-5_å®Œæ•´æŒä»“ç®¡ç†åŠŸèƒ½å®æ–½æŠ¥å‘Š](å®ç›˜/Phase2-5_å®Œæ•´æŒä»“ç®¡ç†åŠŸèƒ½å®æ–½æŠ¥å‘Š_2026-01-30-11_35.md)
- âœ… [å‚æ•°åŠ è½½ä¿®å¤æŠ¥å‘Š](å®ç›˜/å‚æ•°åŠ è½½ä¿®å¤æŠ¥å‘Š_2026-01-30-11_05.md)

### ğŸ§ª å›æµ‹ç³»ç»Ÿ
[å›æµ‹ç›¸å…³æ–‡æ¡£å¯¼èˆª]

### [å…¶ä»–ä¸»é¢˜...]

## ğŸ” å¸¸è§é—®é¢˜é€ŸæŸ¥
[é—®é¢˜ â†’ å‚è€ƒæ–‡æ¡£æ˜ å°„è¡¨]
```

---

## å¼€å‘å·¥ä½œæµ

### æ„å»ºç³»ç»Ÿ

```bash
# C++ ç½‘å…³ç¼–è¯‘
cd gateway
mkdir -p build && cd build
cmake ..
make -j4

# Golang ç¼–è¯‘ï¼ˆè¾“å‡ºåˆ°é¡¹ç›®æ ¹ç›®å½• bin/ï¼‰
cd golang
go build -o ../bin/trader cmd/trader/main.go

# æˆ–è€…ä»é¡¹ç›®æ ¹ç›®å½•æ„å»º
go build -C golang -o bin/trader cmd/trader/main.go
```

### è¿è¡Œæµ‹è¯•

**ç«¯åˆ°ç«¯æµ‹è¯•** (æ¨è):
```bash
# 1. å¯åŠ¨ NATS
nats-server &

# 2. è¿è¡Œå®Œæ•´é“¾è·¯æµ‹è¯•
./test_full_chain.sh

# 3. æ¿€æ´»ç­–ç•¥ï¼ˆç­‰å¾… 5 ç§’å¯åŠ¨å®Œæˆï¼‰
sleep 5
curl -X POST http://localhost:9201/api/v1/strategy/activate \
  -H "Content-Type: application/json" \
  -d '{"strategy_id": "test_92201"}'

# 4. ç›‘æ§è®¢å•ç”Ÿæˆ
tail -f log/trader.test.log | grep "Order sent"

# 5. åœæ­¢æµ‹è¯•
pkill -f md_simulator
pkill -f md_gateway
pkill -f ors_gateway
pkill -f counter_gateway
pkill -f "trader -config"

# 6. æ¸…ç†å…±äº«å†…å­˜
ipcs -m | grep user | awk '{print $2}' | xargs ipcrm -m
```

**å•å…ƒæµ‹è¯•**:
```bash
# Golang å•å…ƒæµ‹è¯•
cd golang
go test ./pkg/...

# C++ å•å…ƒæµ‹è¯•ï¼ˆå¦‚æœæœ‰ï¼‰
cd gateway/build
ctest
```

### è°ƒè¯•æ–¹æ³•

**æŸ¥çœ‹æ—¥å¿—**:
```bash
# ä¸»æ—¥å¿—
tail -f log/trader.test.log

# è®¢å•è®°å½•
grep "Order sent" log/trader.test.log

# ç­–ç•¥ç»Ÿè®¡
grep "Stats:" log/trader.test.log | tail -20

# å¸‚åœºæ•°æ®æ¥æ”¶
grep "Received market data" log/trader.test.log
```

**æ£€æŸ¥è¿›ç¨‹çŠ¶æ€**:
```bash
ps aux | grep -E "md_simulator|md_gateway|ors_gateway|counter_gateway|trader"
```

**æ£€æŸ¥å…±äº«å†…å­˜**:
```bash
ipcs -m
```

**æ£€æŸ¥ NATS æ¶ˆæ¯**:
```bash
nats sub "md.>"
```

---

## é…ç½®ç®¡ç†

### æµ‹è¯•é…ç½® vs ç”Ÿäº§é…ç½®

**æµ‹è¯•é…ç½®** (`config/trader.test.yaml`):
```yaml
session:
  start_time: "00:00:00"        # å…¨å¤©è¿è¡Œ
  end_time: "23:59:59"
  auto_activate: false           # éœ€è¦æ‰‹åŠ¨æ¿€æ´»

strategy:
  parameters:
    entry_zscore: 0.5            # é™ä½é˜ˆå€¼ä¾¿äºæµ‹è¯•
    exit_zscore: 0.2
```

**ç”Ÿäº§é…ç½®** (`config/trader.yaml`):
```yaml
session:
  start_time: "09:00:00"        # å®é™…äº¤æ˜“æ—¶æ®µ
  end_time: "15:00:00"
  auto_activate: false           # æ¨èæ‰‹åŠ¨æ¿€æ´»

strategy:
  parameters:
    entry_zscore: 2.0            # æ›´ä¿å®ˆçš„é˜ˆå€¼
    exit_zscore: 0.5
```

### å…³é”®é…ç½®é¡¹è¯´æ˜

- **entry_zscore**: Z-Score å…¥åœºé˜ˆå€¼
  - æµ‹è¯•ç¯å¢ƒ: 0.5ï¼ˆå®¹æ˜“è§¦å‘ï¼‰
  - ç”Ÿäº§ç¯å¢ƒ: 2.0ï¼ˆæ›´ä¿å®ˆï¼‰

- **auto_activate**: è‡ªåŠ¨æ¿€æ´»ç­–ç•¥
  - æ¨èè®¾ç½®ä¸º `false`ï¼Œæ‰‹åŠ¨æ¿€æ´»æ›´å®‰å…¨

- **max_position_size**: æœ€å¤§æŒä»“
  - æ ¹æ®è´¦æˆ·èµ„é‡‘å’Œé£é™©æ‰¿å—èƒ½åŠ›è®¾ç½®

---

## é‡è¦çº¦å®š

### NATS ä¸»é¢˜æ ¼å¼

- **å‘å¸ƒæ ¼å¼**: `md.{exchange}.{symbol}`
  - ä¾‹å¦‚: `md.SHFE.ag2502`, `md.SHFE.ag2504`

- **è®¢é˜…æ ¼å¼**: `md.*.{symbol}`
  - ä½¿ç”¨é€šé…ç¬¦æ”¯æŒå¤šäº¤æ˜“æ‰€

### è®¢å• ID æ ¼å¼

- æ ¼å¼: `ORD_{timestamp_nano}`
- ä¾‹å¦‚: `ORD_1769239216860813000`

### å…±äº«å†…å­˜é˜Ÿåˆ—å‘½å

- è¯·æ±‚é˜Ÿåˆ—: `ors_request`
- å“åº”é˜Ÿåˆ—: `ors_response`
- è¡Œæƒ…é˜Ÿåˆ—: `md_queue`

---

## å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ï¼šæ— è®¢å•ç”Ÿæˆ

**æ£€æŸ¥æ¸…å•**:
1. ç­–ç•¥æ˜¯å¦å·²æ¿€æ´»ï¼Ÿ
   ```bash
   curl http://localhost:9201/api/v1/strategy/status
   ```

2. æ˜¯å¦æ¥æ”¶åˆ°å¸‚åœºæ•°æ®ï¼Ÿ
   ```bash
   grep "Received market data" log/trader.test.log
   ```

3. ç›¸å…³ç³»æ•°æ˜¯å¦è¾¾æ ‡ï¼Ÿ
   ```bash
   grep "corr=" log/trader.test.log | tail -5
   ```

4. Z-Score æ˜¯å¦è¶…è¿‡é˜ˆå€¼ï¼Ÿ
   ```bash
   grep "zscore=" log/trader.test.log | tail -5
   ```

5. é˜ˆå€¼æ˜¯å¦è¿‡é«˜ï¼Ÿ
   - æµ‹è¯•ç¯å¢ƒå»ºè®® `entry_zscore: 0.5`

### é—®é¢˜ï¼šå…±äº«å†…å­˜é”™è¯¯

```bash
# æ¸…ç†æ‰€æœ‰å…±äº«å†…å­˜æ®µ
ipcs -m | grep user | awk '{print $2}' | xargs ipcrm -m

# é‡å¯ç›¸å…³è¿›ç¨‹
./test_full_chain.sh
```

### é—®é¢˜ï¼šNATS è¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥ NATS æ˜¯å¦è¿è¡Œ
ps aux | grep nats-server

# é‡å¯ NATS
pkill nats-server
nats-server &
```

### é—®é¢˜ï¼šgRPC è¿æ¥è¶…æ—¶

```bash
# æ£€æŸ¥ ORS Gateway æ˜¯å¦è¿è¡Œ
ps aux | grep ors_gateway

# æ£€æŸ¥ç«¯å£æ˜¯å¦ç›‘å¬
lsof -i :50052
```

---

## å®‰å…¨è§„èŒƒ

### ç¦æ­¢äº‹é¡¹

- âŒ åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†é’¥ã€å¯†ç 
- âŒ æäº¤æ•æ„Ÿé…ç½®æ–‡ä»¶ï¼ˆä½¿ç”¨ `.gitignore`ï¼‰
- âŒ åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ `auto_activate: true`
- âŒ è·³è¿‡é£é™©æ£€æŸ¥
- âŒ åœ¨ä¸äº†è§£çš„æƒ…å†µä¸‹ä¿®æ”¹å…±äº«å†…å­˜ç»“æ„

### æ¨èå®è·µ

- âœ… ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–å¤–éƒ¨é…ç½®ç®¡ç†æ•æ„Ÿä¿¡æ¯
- âœ… æµ‹è¯•æ–°ç­–ç•¥æ—¶å…ˆç”¨å°ä»“ä½
- âœ… å®šæœŸå¤‡ä»½é…ç½®å’Œæ—¥å¿—
- âœ… ä»£ç å®¡æŸ¥å…³æ³¨é£æ§é€»è¾‘
- âœ… æäº¤å‰è¿è¡Œå®Œæ•´æµ‹è¯•

---

## æ–‡ä»¶ç»„ç»‡ç»“æ„

```
quantlink-trade-system/
â”œâ”€â”€ gateway/              # C++ ç½‘å…³ä»£ç 
â”‚   â”œâ”€â”€ src/             # æºæ–‡ä»¶
â”‚   â”œâ”€â”€ include/         # å¤´æ–‡ä»¶
â”‚   â””â”€â”€ build/           # ç¼–è¯‘äº§ç‰©ï¼ˆä¸æäº¤ï¼‰
â”œâ”€â”€ golang/              # Golang ç­–ç•¥ä»£ç 
â”‚   â”œâ”€â”€ cmd/             # ä¸»ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ pkg/             # ä¸šåŠ¡é€»è¾‘åŒ…
â”‚   â””â”€â”€ internal/        # å†…éƒ¨åŒ…
â”œâ”€â”€ config/              # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ trader.yaml      # ç”Ÿäº§é…ç½®
â”‚   â””â”€â”€ trader.test.yaml # æµ‹è¯•é…ç½®
â”œâ”€â”€ bin/                 # å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆä¸æäº¤ï¼‰
â”œâ”€â”€ log/                 # æ—¥å¿—æ–‡ä»¶ï¼ˆä¸æäº¤ï¼‰
â”œâ”€â”€ test_logs/           # æµ‹è¯•æ—¥å¿—ï¼ˆä¸æäº¤ï¼‰
â”œâ”€â”€ docs/                # æ–‡æ¡£ï¼ˆæŒ‰ä¸»é¢˜åˆ†ç±»ï¼‰
â”‚   â”œâ”€â”€ README.md        # æ–‡æ¡£ç´¢å¼•ä¸­å¿ƒ
â”‚   â”œâ”€â”€ æ ¸å¿ƒæ–‡æ¡£/        # ç³»ç»Ÿæ ¸å¿ƒæ–‡æ¡£
â”‚   â”œâ”€â”€ å®ç›˜/            # å®ç›˜äº¤æ˜“ç›¸å…³
â”‚   â”œâ”€â”€ å›æµ‹/            # å›æµ‹ç³»ç»Ÿæ–‡æ¡£
â”‚   â”œâ”€â”€ æµ‹è¯•æŠ¥å‘Š/        # å„ç±»æµ‹è¯•æŠ¥å‘Š
â”‚   â”œâ”€â”€ åŠŸèƒ½å®ç°/        # åŠŸèƒ½å®æ–½æ–‡æ¡£
â”‚   â”œâ”€â”€ ç³»ç»Ÿåˆ†æ/        # ç³»ç»Ÿåˆ†ææ–‡æ¡£
â”‚   â”œâ”€â”€ golang/          # Golangæ¨¡å—æ–‡æ¡£
â”‚   â”œâ”€â”€ gateway/         # Gatewayæ¨¡å—æ–‡æ¡£
â”‚   â””â”€â”€ archive/         # å·²å½’æ¡£æ–‡æ¡£
â”œâ”€â”€ data/                # æ•°æ®ç›®å½•
â”‚   â””â”€â”€ positions/       # æŒä»“å¿«ç…§æ–‡ä»¶
â””â”€â”€ .claude/             # Claude Code è§„åˆ™
```

### .gitignore é‡ç‚¹

```gitignore
# ç¼–è¯‘äº§ç‰©
gateway/build/
bin/
*.o
*.so

# æ—¥å¿—
log/
test_logs/
*.log

# ä¸´æ—¶æ–‡ä»¶
*.swp
*.tmp
.DS_Store

# æ•æ„Ÿé…ç½®
config/*.local.yaml
.env
```

---

## æ€§èƒ½è¦æ±‚

### å»¶è¿ŸæŒ‡æ ‡

- å…±äº«å†…å­˜è¯»å†™: < 1ms
- NATS æ¶ˆæ¯ä¼ è¾“: < 5ms
- ç­–ç•¥è®¡ç®—: < 10ms
- è®¢å•å‘é€: < 20ms
- **ç«¯åˆ°ç«¯å»¶è¿Ÿ**: < 50ms

### èµ„æºé™åˆ¶

- CPU ä½¿ç”¨: å•è¿›ç¨‹ < 20%
- å†…å­˜å ç”¨: å•è¿›ç¨‹ < 100MB
- ç½‘ç»œæµé‡: < 10MB/min

---

## Git å·¥ä½œæµ

### åˆ†æ”¯ç­–ç•¥

- `main`: ç”Ÿäº§ç¨³å®šç‰ˆæœ¬
- `develop`: å¼€å‘ä¸»åˆ†æ”¯
- `feature/*`: æ–°åŠŸèƒ½å¼€å‘
- `bugfix/*`: Bug ä¿®å¤
- `hotfix/*`: ç´§æ€¥ä¿®å¤

### æäº¤è§„èŒƒ

ä½¿ç”¨ Conventional Commits:

```
feat: æ·»åŠ é…å¯¹å¥—åˆ©ç­–ç•¥
fix: ä¿®å¤å…±äº«å†…å­˜æ³„æ¼é—®é¢˜
docs: æ›´æ–°ç«¯åˆ°ç«¯æµ‹è¯•æ–‡æ¡£
refactor: é‡æ„è®¢å•è·¯ç”±é€»è¾‘
test: æ·»åŠ ç­–ç•¥å¼•æ“å•å…ƒæµ‹è¯•
chore: æ›´æ–°ä¾èµ–ç‰ˆæœ¬
```

### æäº¤å‰æ£€æŸ¥

1. âœ… ä»£ç å·²æ ¼å¼åŒ–ï¼ˆC++/Golangï¼‰
2. âœ… é€šè¿‡ç¼–è¯‘
3. âœ… é€šè¿‡å•å…ƒæµ‹è¯•
4. âœ… æ›´æ–°ç›¸å…³æ–‡æ¡£
5. âœ… æ£€æŸ¥ .gitignoreï¼ˆä¸æäº¤æ—¥å¿—ã€äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰

---

## éƒ¨ç½²æ£€æŸ¥æ¸…å•

### ä¸Šçº¿å‰éªŒè¯

- [ ] å®Œæ•´ç«¯åˆ°ç«¯æµ‹è¯•é€šè¿‡
- [ ] é…ç½®æ–‡ä»¶å·²åˆ‡æ¢åˆ°ç”Ÿäº§é…ç½®
- [ ] ç­–ç•¥å‚æ•°å·²è°ƒæ•´åˆ°ä¿å®ˆå€¼ï¼ˆentry_zscore â‰¥ 2.0ï¼‰
- [ ] é£æ§å‚æ•°å·²è®¾ç½®åˆç†å€¼
- [ ] æ—¥å¿—çº§åˆ«è®¾ç½®æ­£ç¡®ï¼ˆinfo æˆ– warnï¼‰
- [ ] èµ„æºç›‘æ§å·²å°±ç»ª
- [ ] å›æ»šæ–¹æ¡ˆå·²å‡†å¤‡

### ç›‘æ§æŒ‡æ ‡

- è®¢å•æˆåŠŸç‡
- ç­–ç•¥ä¿¡å·é¢‘ç‡
- ç³»ç»Ÿå»¶è¿Ÿ
- CPU/å†…å­˜ä½¿ç”¨
- é”™è¯¯æ—¥å¿—æ•°é‡

---

## è”ç³»æ–¹å¼

**ç³»ç»Ÿç»´æŠ¤**: å‚è€ƒ @docs/README.md

**é—®é¢˜åé¦ˆ**: åˆ›å»º Issue æˆ–æäº¤ PR

---

## ğŸ“‹ æ–‡æ¡£é‡ç»„å†å²

**2026-01-30**: å®Œæˆæ–‡æ¡£ç›®å½•é‡ç»„
- å°†114ä¸ªæ–‡æ¡£ä»æ··ä¹±çš„æ ¹ç›®å½•é‡ç»„ä¸º10ä¸ªä¸»é¢˜ç›®å½•
- æ ¹ç›®å½•æ–‡æ¡£ä»73ä¸ªå‡å°‘åˆ°1ä¸ªï¼ˆREADME.mdï¼‰
- åˆ›å»ºå®Œæ•´çš„æ–‡æ¡£ç´¢å¼•å’Œå¯¼èˆªç³»ç»Ÿ
- å½’æ¡£35ä¸ªæ—§æ–‡æ¡£åˆ° archive/
- è¯¦ç»†æŠ¥å‘Š: @docs/ç³»ç»Ÿåˆ†æ/æ–‡æ¡£é‡ç»„å®ŒæˆæŠ¥å‘Š_2026-01-30-23_30.md

**2026-01-30**: å®ŒæˆæŒä»“ç®¡ç†åŠŸèƒ½å®æ–½
- Phase 1-5: æŒä»“æŸ¥è¯¢ã€åˆå§‹åŒ–ã€æŒä¹…åŒ–ã€å®šæœŸæ ¡éªŒ
- ä¿®å¤å‚æ•°åŠ è½½ç±»å‹ä¸åŒ¹é…é—®é¢˜ï¼ˆmin_correlationã€slippage_ticksï¼‰
- å®æ–½åŒé‡ä¿éšœæœºåˆ¶ï¼šCTPæŸ¥è¯¢ + JSONæ–‡ä»¶æ¢å¤
- è¯¦ç»†æŠ¥å‘Š: @docs/å®ç›˜/Phase2-5_å®Œæ•´æŒä»“ç®¡ç†åŠŸèƒ½å®æ–½æŠ¥å‘Š_2026-01-30-11_35.md

---

**æœ€åæ›´æ–°**: 2026-01-30
**æ–‡æ¡£ç‰ˆæœ¬**: v1.2
