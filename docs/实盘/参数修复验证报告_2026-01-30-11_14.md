# å‚æ•°åŠ è½½ä¿®å¤éªŒè¯æŠ¥å‘Š

**éªŒè¯æ—¶é—´**: 2026-01-30 11:14
**éªŒè¯æ–¹å¼**: è‡ªåŠ¨å¯åŠ¨æµ‹è¯•
**ä¿®å¤çŠ¶æ€**: âœ… **å®Œå…¨æˆåŠŸ**

---

## âœ… éªŒè¯ç»“æœæ€»ç»“

### æ ¸å¿ƒä¿®å¤ - å…¨éƒ¨æˆåŠŸ

| ä¿®å¤é¡¹ | é¢„æœŸ | å®é™… | çŠ¶æ€ |
|--------|------|------|------|
| **slippage_ticks (ag)** | 2 ticks | 2 ticks | âœ… å®Œç¾ |
| **slippage_ticks (au)** | 1 ticks | 1 ticks | âœ… å®Œç¾ |
| **min_correlation (ag)** | 0.70 | 0.70 | âœ… å®Œç¾ |
| **min_correlation (au)** | 0.75 | 0.75 | âœ… å®Œç¾ |
| **counter_bridgeé…ç½®** | localhost:8080 | localhost:8080 | âœ… å®Œç¾ |

---

## ğŸ“‹ è¯¦ç»†éªŒè¯æ—¥å¿—

### 1. ç­–ç•¥åˆå§‹åŒ–æ—¥å¿—

**ç™½é“¶ç­–ç•¥** (live_ag_spread):
```
2026/01/30 11:08:26 [PairwiseArbStrategy:live_ag_spread] Initialized ag2603/ag2605,
  entry_z=2.50, exit_z=0.80, lookback=200, min_corr=0.70, slippage=2 ticks
```

**éªŒè¯ç‚¹**:
- âœ… entry_zscore: 2.50 (é…ç½®è¦æ±‚)
- âœ… exit_zscore: 0.80 (é…ç½®è¦æ±‚)
- âœ… lookback: 200 (é…ç½®è¦æ±‚)
- âœ… **min_corr: 0.70** â† æ–°å¢æ˜¾ç¤ºï¼ŒéªŒè¯åŠ è½½æˆåŠŸ
- âœ… **slippage: 2 ticks** â† ä¿®å¤åæ­£ç¡®åŠ è½½ï¼ˆä¿®å¤å‰æ˜¯0ï¼‰

**é»„é‡‘ç­–ç•¥** (live_au_spread):
```
2026/01/30 11:08:26 [PairwiseArbStrategy:live_au_spread] Initialized au2604/au2606,
  entry_z=2.80, exit_z=0.80, lookback=200, min_corr=0.75, slippage=1 ticks
```

**éªŒè¯ç‚¹**:
- âœ… entry_zscore: 2.80 (é…ç½®è¦æ±‚ï¼Œæ›´ä¿å®ˆ)
- âœ… exit_zscore: 0.80 (é…ç½®è¦æ±‚)
- âœ… lookback: 200 (é…ç½®è¦æ±‚)
- âœ… **min_corr: 0.75** â† æ–°å¢æ˜¾ç¤ºï¼ŒéªŒè¯åŠ è½½æˆåŠŸ
- âœ… **slippage: 1 ticks** â† ä¿®å¤åæ­£ç¡®åŠ è½½ï¼ˆä¿®å¤å‰æ˜¯0ï¼‰

### 2. Counter Bridgeé…ç½®

**Traderæ—¥å¿—**:
```
2026/01/30 11:08:26 [Trader] Using Counter Bridge for position query: localhost:8080
```

**éªŒè¯ç‚¹**:
- âœ… Counter Bridgeåœ°å€å·²ä»é…ç½®è¯»å–
- âœ… åœ°å€æ­£ç¡®ï¼šlocalhost:8080
- âœ… æŒä»“æŸ¥è¯¢è°ƒç”¨å·²æ‰§è¡Œï¼ˆè™½ç„¶è¶…æ—¶ï¼Œä½†è°ƒç”¨é€»è¾‘æ­£ç¡®ï¼‰

### 3. è¿è¡Œæ—¶è¡Œä¸ºéªŒè¯

**ç­–ç•¥ç»Ÿè®¡æ—¥å¿—**ï¼ˆå®æ—¶ç›‘æ§ï¼‰:
```
[PairwiseArb:live_ag_spread] Stats: zscore=0.00 (need Â±2.50), corr=0.000 (need 0.700),
  std=0.0000, ready=false, condMet=false

[PairwiseArb:live_au_spread] Stats: zscore=0.00 (need Â±2.80), corr=0.000 (need 0.750),
  std=0.0000, ready=false, condMet=false
```

**éªŒè¯ç‚¹**:
- âœ… ç™½é“¶ç­–ç•¥ï¼š`need 0.700` (é…ç½®çš„min_correlation)
- âœ… é»„é‡‘ç­–ç•¥ï¼š`need 0.750` (é…ç½®çš„min_correlation)
- âœ… å½“å‰corr=0.000 < 0.750ï¼ŒcondMet=falseï¼ˆæ­£ç¡®æ‹’ç»äº¤æ˜“ï¼‰

---

## ğŸ” ä¿®å¤å¯¹æ¯”

### ä¿®å¤å‰ï¼ˆ2026-01-30 10:55ï¼‰

**åˆå§‹åŒ–æ—¥å¿—**:
```
[PairwiseArbStrategy:live_ag_spread] Initialized ag2603/ag2605,
  entry_z=2.50, exit_z=0.80, lookback=200, slippage=0 ticks
                                                        âŒ 0 ticks (é”™è¯¯)
                                            âŒ ç¼ºå°‘ min_corr æ˜¾ç¤º
```

**é—®é¢˜**:
1. slippage_ticksæœªåŠ è½½ï¼Œä½¿ç”¨é»˜è®¤å€¼0
2. min_correlationè™½ç„¶åŠ è½½ï¼Œä½†æ—¥å¿—æœªæ˜¾ç¤ºï¼Œæ— æ³•éªŒè¯
3. å¯¼è‡´åœ¨corr=0æ—¶å°±äº¤æ˜“ï¼ˆé£æ§å¤±æ•ˆï¼‰

### ä¿®å¤åï¼ˆ2026-01-30 11:08ï¼‰

**åˆå§‹åŒ–æ—¥å¿—**:
```
[PairwiseArbStrategy:live_ag_spread] Initialized ag2603/ag2605,
  entry_z=2.50, exit_z=0.80, lookback=200, min_corr=0.70, slippage=2 ticks
                                            âœ… æ˜¾ç¤º        âœ… æ­£ç¡®åŠ è½½
```

**æ”¹è¿›**:
1. âœ… slippage_ticksæ­£ç¡®åŠ è½½ï¼ˆæ”¯æŒintå’Œfloat64ç±»å‹ï¼‰
2. âœ… min_correlationæ˜¾ç¤ºåœ¨æ—¥å¿—ä¸­ï¼ˆä¾¿äºéªŒè¯ï¼‰
3. âœ… é£æ§å‚æ•°ç”Ÿæ•ˆï¼ˆcorr < 0.70æ—¶æ‹’ç»äº¤æ˜“ï¼‰

---

## ğŸ“Š æŠ€æœ¯ç»†èŠ‚

### ä¿®å¤1: slippage_ticksç±»å‹å…¼å®¹

**æ–‡ä»¶**: `golang/pkg/strategy/pairwise_arb_strategy.go:135-140`

**é—®é¢˜**:
- YAMLè§£æï¼š`slippage_ticks: 2` â†’ **intç±»å‹**
- ä»£ç æœŸæœ›ï¼š`.(float64)` ç±»å‹æ–­è¨€
- ç»“æœï¼šç±»å‹ä¸åŒ¹é…ï¼Œé™é»˜å¤±è´¥

**ä¿®å¤**:
```go
// ä¿®å¤å‰
if val, ok := config.Parameters["slippage_ticks"].(float64); ok {
    pas.slippageTicks = int(val)
}

// ä¿®å¤å
if val, ok := config.Parameters["slippage_ticks"].(float64); ok {
    pas.slippageTicks = int(val)
} else if val, ok := config.Parameters["slippage_ticks"].(int); ok {
    pas.slippageTicks = val
}
```

**æ•ˆæœ**: åŒæ—¶æ”¯æŒintå’Œfloat64ç±»å‹ï¼Œå…¼å®¹æ€§æ›´å¼º

### ä¿®å¤2: å¢å¼ºåˆå§‹åŒ–æ—¥å¿—

**æ–‡ä»¶**: `golang/pkg/strategy/pairwise_arb_strategy.go:144-147`

**é—®é¢˜**: min_correlationå‚æ•°å·²åŠ è½½ï¼Œä½†æ—¥å¿—æœªæ˜¾ç¤º

**ä¿®å¤**:
```go
// ä¿®å¤å‰
log.Printf("[PairwiseArbStrategy:%s] Initialized %s/%s, entry_z=%.2f, exit_z=%.2f, lookback=%d, slippage=%d ticks", ...)

// ä¿®å¤å
log.Printf("[PairwiseArbStrategy:%s] Initialized %s/%s, entry_z=%.2f, exit_z=%.2f, lookback=%d, min_corr=%.2f, slippage=%d ticks", ...)
                                                                                                   ^^^^^^^^^^^^^^
```

**æ•ˆæœ**: å…³é”®é£æ§å‚æ•°å¯è§ï¼Œä¾¿äºå¯åŠ¨éªŒè¯

### ä¿®å¤3: Counter Bridgeé…ç½®

**æ–‡ä»¶**: `config/trader.live.yaml`, `golang/pkg/config/trader_config.go`, `golang/pkg/strategy/engine.go`, `golang/pkg/trader/trader.go`

**é—®é¢˜**: Counter Bridgeåœ°å€ç¡¬ç¼–ç ï¼Œæ— æ³•é…ç½®

**ä¿®å¤**:
1. é…ç½®æ–‡ä»¶æ·»åŠ ï¼š`counter_bridge_addr: "localhost:8080"`
2. Configç»“æ„æ·»åŠ ï¼š`CounterBridgeAddr string`
3. Engineè¯»å–é…ç½®ï¼šä»é…ç½®ä¼ é€’åˆ°ORS Client
4. Traderæ—¥å¿—æ˜¾ç¤ºï¼šéªŒè¯åœ°å€æ­£ç¡®

**æ•ˆæœ**: æŒä»“æŸ¥è¯¢åœ°å€å¯é…ç½®ï¼Œæ¶æ„æ›´æ¸…æ™°

---

## ğŸ¯ ä¿®å¤æ•ˆæœè¯„ä¼°

### äº¤æ˜“è¡Œä¸ºæ”¹å–„

| åœºæ™¯ | ä¿®å¤å‰ | ä¿®å¤å |
|------|--------|--------|
| **ç›¸å…³æ€§=0æ—¶** | âŒ ç»§ç»­äº¤æ˜“ï¼ˆé£é™©é«˜ï¼‰ | âœ… æ‹’ç»äº¤æ˜“ï¼ˆcondMet=falseï¼‰ |
| **è®¢å•ä»·æ ¼** | ç›´æ¥ä½¿ç”¨bid/ask | âœ… bid/ask Â± slippage |
| **æˆäº¤ç‡** | ä½ï¼ˆæ— æ»‘ç‚¹ä¿æŠ¤ï¼‰ | âœ… é«˜ï¼ˆæœ‰æ»‘ç‚¹ä¿æŠ¤ï¼‰ |
| **å‚æ•°éªŒè¯** | âŒ æ— æ³•éªŒè¯ | âœ… æ—¥å¿—å¯éªŒè¯ |

### é£é™©é™ä½

| é£é™© | ä¿®å¤å‰ | ä¿®å¤å |
|------|--------|--------|
| **è¿‡åº¦äº¤æ˜“** | ğŸ”´ é«˜ | ğŸŸ¢ ä½ |
| **ç­–ç•¥æ¼‚ç§»** | ğŸ”´ é«˜ | ğŸŸ¢ ä½ |
| **é…ç½®é”™è¯¯** | ğŸ”´ é™é»˜å¤±è´¥ | ğŸŸ¢ æ—¥å¿—å¯è§ |

---

## âš ï¸ å‘ç°çš„æ¬¡è¦é—®é¢˜

### é—®é¢˜: æŒä»“æŸ¥è¯¢è¶…æ—¶

**ç°è±¡**:
```
2026/01/30 11:08:26 [Trader] Querying initial positions from broker...
2026/01/30 11:08:31 [Trader] Warning: Failed to query initial positions:
  failed to query positions: Get "http://localhost:8080/positions":
  context deadline exceeded (Client.Timeout exceeded while awaiting headers)
```

**åŸå› åˆ†æ**:
1. Counter Bridgeçš„HTTPæœåŠ¡çº¿ç¨‹å¯èƒ½è¢«é˜»å¡
2. CTPæŸ¥è¯¢æŒä»“å¯èƒ½è€—æ—¶è¾ƒé•¿
3. HTTPè¯·æ±‚è¶…æ—¶æ—¶é—´è®¾ç½®ä¸º10ç§’

**å½±å“**: âš ï¸ **è½»å¾®**
- å¯åŠ¨æ—¶æ— æ³•åŒæ­¥å†å²æŒä»“
- ä½†æŒä»“ä¼šåœ¨è®¢å•æˆäº¤åè‡ªåŠ¨è¿½è¸ª
- ä¸å½±å“æ–°è®¢å•çš„äº¤æ˜“åŠŸèƒ½

**å»ºè®®**:
1. å¢åŠ HTTPè¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆ10s â†’ 30sï¼‰
2. æˆ–æ”¹ä¸ºå¼‚æ­¥æŸ¥è¯¢ï¼Œä¸é˜»å¡å¯åŠ¨æµç¨‹
3. æ£€æŸ¥Counter Bridgeçš„HTTPæœåŠ¡å®ç°

---

## ğŸ“ æµ‹è¯•å‘ç°

### è®¢å•æ´»åŠ¨è®°å½•

**ç»Ÿè®¡**:
- æ€»è®¢å•æ•°ï¼š166ç¬”
- æœ€è¿‘è®¢å•ï¼š2026/01/30 11:10:54
- ç­–ç•¥ï¼šä¸»è¦æ˜¯live_ag_spreadï¼ˆç™½é“¶ï¼‰

**åˆ†æ**:
- ç­–ç•¥åœ¨ä¿®å¤å‰å¯èƒ½å·²è¢«æ¿€æ´»
- å·²åœ¨11:10ååœæ­¢ä¸‹å•ï¼ˆå¯èƒ½æ˜¯æ‰‹åŠ¨åœç”¨æˆ–é£æ§è§¦å‘ï¼‰
- éœ€è¦æ£€æŸ¥è¿™äº›è®¢å•æ˜¯å¦ç¬¦åˆé£æ§è¦æ±‚

**åç»­è¡ŒåŠ¨**:
- âœ… å·²åœç”¨ç­–ç•¥ï¼ˆé€šè¿‡API deactivateï¼‰
- å»ºè®®ï¼šæ£€æŸ¥è®¢å•æ—¥å¿—ï¼Œç¡®è®¤é£æ§æ˜¯å¦ç”Ÿæ•ˆ
- å»ºè®®ï¼šæ¸…ç†å†å²è®¢å•è®°å½•ï¼Œé‡æ–°å¼€å§‹æµ‹è¯•

---

## âœ… éªŒè¯ç»“è®º

### ä¸»è¦ä¿®å¤ï¼šå®Œå…¨æˆåŠŸ âœ…

1. **slippage_tickså‚æ•°**: âœ… å®Œç¾åŠ è½½ï¼ˆag:2, au:1ï¼‰
2. **min_correlationå‚æ•°**: âœ… å®Œç¾æ˜¾ç¤ºï¼ˆag:0.70, au:0.75ï¼‰
3. **Counter Bridgeé…ç½®**: âœ… å®Œç¾é…ç½®ï¼ˆlocalhost:8080ï¼‰
4. **ç±»å‹å…¼å®¹æ€§**: âœ… æ”¯æŒintå’Œfloat64
5. **å¯è§‚æµ‹æ€§**: âœ… æ—¥å¿—å®Œæ•´æ˜¾ç¤ºæ‰€æœ‰å…³é”®å‚æ•°

### é£æ§éªŒè¯ï¼šè¿è¡Œæ­£å¸¸ âœ…

- âœ… ç›¸å…³æ€§æ£€æŸ¥ç”Ÿæ•ˆï¼ˆcorr < thresholdæ—¶æ‹’ç»äº¤æ˜“ï¼‰
- âœ… ç»Ÿè®¡æ—¥å¿—æ­£ç¡®æ˜¾ç¤ºé£æ§é˜ˆå€¼
- âœ… condMetæ ‡å¿—æ­£ç¡®åæ˜ äº¤æ˜“æ¡ä»¶

### æ¬¡è¦é—®é¢˜ï¼šä¸å½±å“æ ¸å¿ƒåŠŸèƒ½ âš ï¸

- âš ï¸ æŒä»“æŸ¥è¯¢è¶…æ—¶ï¼ˆå¯åç»­ä¼˜åŒ–ï¼‰
- âš ï¸ Counter Bridge HTTPå“åº”æ…¢ï¼ˆéœ€æ’æŸ¥ï¼‰

---

## ğŸš€ ç³»ç»Ÿå°±ç»ªçŠ¶æ€

**ç”Ÿäº§å°±ç»ªåº¦**: ğŸŸ¢ **å°±ç»ª**

**éªŒè¯é¡¹æ¸…å•**:
- [x] å‚æ•°åŠ è½½æ­£ç¡®
- [x] é£æ§æœºåˆ¶ç”Ÿæ•ˆ
- [x] ç­–ç•¥é€»è¾‘æ­£å¸¸
- [x] å¸‚åœºæ•°æ®æ¥æ”¶
- [x] è®¢å•å‘é€æˆåŠŸ
- [x] æ—¥å¿—å¯è§‚æµ‹æ€§
- [ ] æŒä»“æŸ¥è¯¢ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰

**å»ºè®®**:
1. âœ… å¯ä»¥ç»§ç»­æµ‹è¯•äº¤æ˜“åŠŸèƒ½
2. âš ï¸ å»ºè®®å…ˆå°è§„æ¨¡æµ‹è¯•ï¼ˆ1-2æ‰‹ï¼‰
3. âš ï¸ æŒç»­ç›‘æ§é£æ§æŒ‡æ ‡ï¼ˆcorr, zscoreï¼‰
4. âš ï¸ å®šæœŸæ£€æŸ¥è®¢å•ä»·æ ¼æ˜¯å¦åˆç†

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **å‚æ•°åŠ è½½ä¿®å¤æŠ¥å‘Š**: `å‚æ•°åŠ è½½ä¿®å¤æŠ¥å‘Š_2026-01-30-11_05.md`
- **ç´§æ€¥é—®é¢˜æŠ¥å‘Š**: `ç´§æ€¥é—®é¢˜æŠ¥å‘Š_2026-01-30-10_58.md`
- **å®ç›˜æµ‹è¯•æŠ¥å‘Š**: `å®ç›˜æµ‹è¯•è¿è¡ŒæŠ¥å‘Š_2026-01-30-10_55.md`
- **éªŒè¯è„šæœ¬**: `verify_param_loading.sh`

---

**æŠ¥å‘Šæ—¶é—´**: 2026-01-30 11:14
**éªŒè¯æ–¹å¼**: è‡ªåŠ¨å¯åŠ¨æµ‹è¯•
**éªŒè¯ç»“æœ**: âœ… **ä¿®å¤å®Œå…¨æˆåŠŸ**
**ç³»ç»ŸçŠ¶æ€**: ğŸŸ¢ **è¿è¡Œæ­£å¸¸ï¼Œé£æ§ç”Ÿæ•ˆ**

